<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>ZXScreen - ZX Spectrum Screen Simulator</title>
</head>
<body>
  <div id="zxs"></div>

  <script type="module"> 
    import * as zx from './js/zxscreen.js'
    zx.screen(document.getElementById('zxs'), {pixelSize:2})

    function dump() {
      zx.poke$(16384, Uint8Array.from({length: 6912}, ()=>~~(Math.random()*255)))
    }

    document.onclick = dump

    function load(fname = 'test1') {
      let oReq = new XMLHttpRequest()
      oReq.open("GET", `${fname}.scr`, true)
      oReq.responseType = "arraybuffer"
      oReq.onload = function () {
        let arrayBuffer = oReq.response
        if (arrayBuffer) {
          let byteArray = new Uint8Array(arrayBuffer)
          zx.poke$(16384, byteArray)
        }
      }
      oReq.send(null)
    }
    window.load = load
  </script>
</body>
</html>